<HTML>
	<HEAD>
		<TITLE>Terminal 5250</TITLE>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

		<SCRIPT LANGUAGE="JScript">
			var SizeBig = true;
			
			function MyOnLoadPage()
			{
				Term5250.MouseMoveCursor=true;
				Term5250.SelectionEnabled = false;
				window.defaultStatus = "Waiting to connect";
				<!--Term5250.Connect();-->
				Term5250.focus();
			}
			function Connect()
			{
				Term5250.HostName = IP.value;
				Term5250.Connect();
				Term5250.focus();
			}
	
			function Disconnect()
			{
				Term5250.Disconnect();
			}
	
			function SetBKColor()
			{
				// inverted...
				var cR = eval(B.value);
				var cG = eval(G.value);
				var cB = eval(R.value);
				Term5250.BackColor = ((cR*256*256) + (cG*256) + cB);
			}
	
			function SetFGColor()
			{
				// inverted...
				var cR = eval(B.value);
				var cG = eval(G.value);
				var cB = eval(R.value);
				Term5250.ForeColor = ((cR*256*256) + (cG*256) + cB);
			}
			
			function InvertColor()
			{
				var Fore = Term5250.BackColor;
				Term5250.BackColor = Term5250.ForeColor;
				Term5250.ForeColor = Fore;
			}
	
			function SendVK()
			{
				var MyVK = eval(VK.value);
				Term5250.SendVkey(MyVK);
			}
			function SendChar()
			{
				var MyVK = eval(VK.value);
				Term5250.SendChar(MyVK);
			}
			
			function SetMouseMove()
			{
	 			var MyVK = eval(VK.value);
	 			Term5250.MouseMoveCursor = MyVK;
			}
			function ToggleSize()
			{
				if ( SizeBig )
				{
					ResizeSmall();
					SizeBig = false;
				}
				else
				{
					ResizeBig();
					SizeBig = true;
				}
				//Term5250.focus();
			}

			function ResizeSmall()
			{
	  			Term5250.style.width = 564;
	  			Term5250.style.height = 352;
			}
			function ResizeBig()
			{
	  			Term5250.style.width = 884;
	  			Term5250.style.height = 579;
			}
			
			function OnReset()
			{
				Term5250.SendChar(0x12);
				Term5250.focus();
			}
			
		</SCRIPT>
		<SCRIPT FOR="Term5250" EVENT="Connected()" LANGUAGE="JScript">
				window.defaultStatus = "Connected to " + Term5250.HostName;
				<!--window.alert("Connected!");-->
		</SCRIPT>
		<SCRIPT FOR="Term5250" EVENT="Disconnected()" LANGUAGE="JScript">
				window.defaultStatus = "Disconnected";
		</SCRIPT>

	</HEAD>
	<BODY OnLoad="MyOnLoadPage()">
		Custom AS/400 Terminal<p>
		<OBJECT id="Term5250" style="width:564;height:352" classid="CLSID:4F051715-BD6B-4BEF-988A-6F70E7F149FC"></OBJECT>
		<br>
		<INPUT type="text" name="IP" value="timeshare.ediconsulting.com" size="20">
		<INPUT type="button" value="Connect" onclick="Connect()">
		<INPUT type="button" value="Disconnect" onclick="Disconnect()">
		<br>
		<INPUT type="text" maxlength="4" size="4" name="VK" value="0">
		<INPUT type="button" value="SendVirtualKey" onclick="SendVK()">
		<INPUT type="button" value="SendChar" onclick="SendChar()">
		<INPUT type="button" value="SetMouseMove" onclick="SetMouseMove()">
		<INPUT type="button" name="ToggleSizeBtn" value="Toggle Size" onclick="ToggleSize()">
		<br>
		<INPUT type="text" maxlength="3" size="3" name="R" value="255">
		<INPUT type="text" maxlength="3" size="3" name="G" value="255">
		<INPUT type="text" maxlength="3" size="3" name="B" value="255">
		<INPUT type="button" value="SetBKColor" onclick="SetBKColor()">
		<INPUT type="button" value="SetFGColor" onclick="SetFGColor()">
		<INPUT type="button" value="InvertColor" onclick="InvertColor()">
		<INPUT type="button" value="Reset" onclick="OnReset()">
	</BODY>
</HTML>
