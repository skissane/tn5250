<HTML>
	<HEAD>
		<TITLE>Terminal 5250</TITLE>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

		<SCRIPT LANGUAGE="JScript">
			function MyOnLoadPage()
			{
				window.defaultStatus = "Waiting to connect. Please click on the ConnectDialog button.";
				Term5250.HostName = "as400";
				//Term5250.MouseMoveCursor = true;
				
				// Initialize fields
				HostName.value         = Term5250.HostName;
				DeviceName.value       = Term5250.DeviceName;
				CodePage.value         = Term5250.CodePage;
				FontName.value         = Term5250.FontName;
				Caption.value          = Term5250.Caption;
				Wide.value             = Term5250.Wide;
				ContextualMenu.value   = Term5250.ContextualMenu;
				Enhanced.value         = Term5250.Enhanced;
				CaretStyle.value       = Term5250.CaretStyle;
				ShowConnect.value      = Term5250.ShowConnect;
				DisplayRuler.value     = Term5250.DisplayRuler;
				UseComputerName.value  = Term5250.UseComputerName;
				MouseMoveCursor.value  = Term5250.MouseMoveCursor;
				SelectionEnabled.value = Term5250.SelectionEnabled;
				HotSpot.value          = Term5250.HotSpot;
				//CursorPositionX.value = Term5250.CursorPositionX;	// doesn't work until the terminal is connected
				//CursorPositionY.value = Term5250.CursorPositionY;
				CursorPositionX.value = 0;
				CursorPositionY.value = 0;
				Term5250.focus();
			}

			function SetBKColor()
			{
				// inverted...
				var cR = eval(A.value);
				var cG = eval(B.value);
				var cB = eval(C.value);
				Term5250.BackColor = ((cR*256*256) + (cG*256) + cB);
			}
	
			function SetFGColor()
			{
				// inverted...
				var cR = eval(A.value);
				var cG = eval(B.value);
				var cB = eval(C.value);
				Term5250.ForeColor = ((cR*256*256) + (cG*256) + cB);
			}
			
			function SetBorderColor()
			{
				// inverted...
				var cR = eval(A.value);
				var cG = eval(B.value);
				var cB = eval(C.value);
				Term5250.BorderColor = ((cR*256*256) + (cG*256) + cB);
			}
			
			function InvertColor()
			{
				var Fore = Term5250.BackColor;
				Term5250.BackColor = Term5250.ForeColor;
				Term5250.ForeColor = Fore;
			}

			function SendVK()
			{
				var MyVK = eval(A.value);
				var Modifiers = eval(B.value);
				Term5250.SendVkey(MyVK, Modifiers);
			}

			function BindVK()
			{
				var VirtualKeyCode = eval(A.value);
				var Modifiers = eval(B.value);
				var KValue = eval(C.value);
				Term5250.BindKey(VirtualKeyCode, Modifiers, KValue);
			}

			// Once you resize it, it's too late to get back the original size
			function resize()
			{
				var X = eval(A.value);
				var Y = eval(B.value);
				Term5250.style.width = X;
				Term5250.style.heigth = Y;
				Term5250.focus();
			}
			
		</SCRIPT>
		<SCRIPT FOR="Term5250" EVENT="Connected()" LANGUAGE="JScript">
				window.defaultStatus = "Connected to " + Term5250.HostName;
				CursorPositionX.value = Term5250.CursorPositionX;
				CursorPositionY.value = Term5250.CursorPositionY;
				<!--window.alert("Connected!");-->
		</SCRIPT>
		<SCRIPT FOR="Term5250" EVENT="Disconnected()" LANGUAGE="JScript">
				window.defaultStatus = "Disconnected";
		</SCRIPT>

	</HEAD>
	<BODY OnLoad="MyOnLoadPage()" scroll=no BOTTOMMARGIN=0 LEFTMARGIN=0 RIGHTMARGIN=0 TOPMARGIN=0>
		<TABLE BORDER=0 HEIGHT=100% WIDTH=100% CELLPADDING="0" CELLSPACING="0">
		<TBODY>
		<TR>
		<TD ALIGN="center">
		<OBJECT id="Term5250" style="width:100%;height:100%"
			classid="CLSID:4F051715-BD6B-4BEF-988A-6F70E7F149FC"
			CODEBASE="a5250.cab#Version=1,17,0,2" VIEWASTEXT>
		</object>
		</TD>
		</TR>
		<TR>
		<TD HEIGHT=1>
		<INPUT type="button" value="Connect"       onclick="Term5250.Connect(); Term5250.focus()" />
		<INPUT type="button" value="ConnectDialog" onclick="Term5250.ConnectDialog(); Term5250.focus()" />
		<INPUT type="button" value="Disconnect"    onclick="Term5250.Disconnect()" />
		 Hover the mouse over the text boxes to see their corresponding property.
		<br>
		Properties: 
		<INPUT type="text" size="20" name="HostName"         title="HostName"         onfocusin="value = Term5250.HostName"         onfocusout="Term5250.HostName = value" />
		<INPUT type="text" size="6"  name="DeviceName"       title="Device Name"      onfocusin="value = Term5250.DeviceName"       onfocusout="Term5250.DeviceName = value" />
		<INPUT type="text" size="3"  name="CodePage"         title="CodePage"         onfocusin="value = Term5250.CodePage"         onfocusout="Term5250.CodePage = value" />
		<INPUT type="text" size="4"  name="Caption"          title="Caption"          onfocusin="value = Term5250.Caption"          onfocusout="Term5250.Caption  = value" />
		<INPUT type="text" size="15" name="FontName"         title="FontName"         onfocusin="value = Term5250.FontName"         onfocusout="Term5250.FontName = value" />
		<INPUT type="text" size="2"  name="Wide"             title="Wide"             onfocusin="value = Term5250.Wide"             onfocusout="Term5250.Wide = value" />
		<INPUT type="text" size="2"  name="ContextualMenu"   title="Contextual Menu"  onfocusin="value = Term5250.ContextualMenu"   onfocusout="Term5250.ContextualMenu = value" />
		<INPUT type="text" size="2"  name="Enhanced"         title="Enhanced"         onfocusin="value = Term5250.Enhanced"         onfocusout="Term5250.Enhanced = value" />
		<INPUT type="text" size="2"  name="CaretStyle"       title="Caret Style"      onfocusin="value = Term5250.CaretStyle"       onfocusout="Term5250.CaretStyle = value" />
		<INPUT type="text" size="2"  name="ShowConnect"      title="ShowConnect"      onfocusin="value = Term5250.ShowConnect"      onfocusout="Term5250.ShowConnect = value" />
		<INPUT type="text" size="2"  name="DisplayRuler"     title="DisplayRuler"     onfocusin="value = Term5250.DisplayRuler"     onfocusout="Term5250.DisplayRuler = value" />
		<INPUT type="text" size="2"  name="UseComputerName"  title="UseComputerName"  onfocusin="value = Term5250.UseComputerName"  onfocusout="Term5250.UseComputerName = value" />
		<INPUT type="text" size="2"  name="MouseMoveCursor"  title="MouseMoveCursor"  onfocusin="value = Term5250.MouseMoveCursor"  onfocusout="Term5250.MouseMoveCursor = value" />
		<INPUT type="text" size="2"  name="SelectionEnabled" title="SelectionEnabled" onfocusin="value = Term5250.SelectionEnabled" onfocusout="Term5250.SelectionEnabled = value" />
		<INPUT type="text" size="2"  name="HotSpot"          title="HotSpot"          onfocusin="value = Term5250.HotSpot"          onfocusout="Term5250.HotSpot = value" />
		<INPUT type="text" size="2"  name="CursorPositionX"  title="CursorPositionX"  onfocusin="value = Term5250.CursorPositionX"  onfocusout="Term5250.CursorPositionX = value" />
		<INPUT type="text" size="2"  name="CursorPositionY"  title="CursorPositionY"  onfocusin="value = Term5250.CursorPositionY"  onfocusout="Term5250.CursorPositionY = value" />

		<INPUT type="text" size="2"  title="Screen Width"  onfocusin="value = Term5250.ScreenWidth" />
		<INPUT type="text" size="2"  title="Screen Height" onfocusin="value = Term5250.ScreenHeight" />
		<br>
		Tools: 
		<INPUT type="text" size="4" name="A" title="A" value="0" />
		<INPUT type="text" size="4" name="B" title="B" value="255" />
		<INPUT type="text" size="4" name="C" title="C" value="255" />
		&nbsp;
		<INPUT type="text" size="20" name="Scratch" title="Scratch" />

		<INPUT type="button" value="SendVirtualKey" onclick="SendVK()" />
		<INPUT type="button" value="SendChar"       onclick="Term5250.SendChar( eval(A.value) )" />
		<INPUT type="button" value="BindVK"         onclick="BindVK()" />
		<INPUT type="button" value="ScreenScrape"   onclick="Scratch.value = Term5250.ScreenScrape(eval(A.value), eval(B.value), eval(C.value)) ; Term5250.focus()" />
		&nbsp;
		<INPUT type="button" value="Resize"         onclick="resize()" />
		&nbsp;
		<INPUT type="button" value="SetBKColor"     onclick="SetBKColor()" />
		<INPUT type="button" value="SetFGColor"     onclick="SetFGColor()" />
		<!-- Borders don't work well <INPUT type="button" value="SetBorderColor" onclick="SetBorderColor()" />
		<INPUT type="button" value="Toggle Border" onclick="Term5250.BorderVisible = !Term5250.BorderVisible; Term5250.focus()" />
		<INPUT type="button" value="SetBorderWidth" onclick="Term5250.BorderWidth = eval(A.value); Term5250.focus()" /> -->
		<INPUT type="button" value="InvertColor"    onclick="InvertColor()" />
		</TD>
		</TR>
		</TBODY>
		</TABLE>
	</BODY>
</HTML>
